import"../chunks/CWj6FrbW.js";import"../chunks/DIt9Bumx.js";import{o as _}from"../chunks/39mzmLjH.js";import{p as U,f as B,b as V,c as C}from"../chunks/CMtSGoh-.js";import{i as z}from"../chunks/D5SIYpj2.js";var L=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,r=arguments.length;r--;)t+=arguments[r]*arguments[r];return Math.sqrt(t)});function R(){var t=new L(16);return L!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function I(t,r,m){var s=m[0],a=m[1],d=m[2],h,p,u,x,A,P,v,w,S,M,e,i;return r===t?(t[12]=r[0]*s+r[4]*a+r[8]*d+r[12],t[13]=r[1]*s+r[5]*a+r[9]*d+r[13],t[14]=r[2]*s+r[6]*a+r[10]*d+r[14],t[15]=r[3]*s+r[7]*a+r[11]*d+r[15]):(h=r[0],p=r[1],u=r[2],x=r[3],A=r[4],P=r[5],v=r[6],w=r[7],S=r[8],M=r[9],e=r[10],i=r[11],t[0]=h,t[1]=p,t[2]=u,t[3]=x,t[4]=A,t[5]=P,t[6]=v,t[7]=w,t[8]=S,t[9]=M,t[10]=e,t[11]=i,t[12]=h*s+A*a+S*d+r[12],t[13]=p*s+P*a+M*d+r[13],t[14]=u*s+v*a+e*d+r[14],t[15]=x*s+w*a+i*d+r[15]),t}function D(t,r,m,s,a){var d=1/Math.tan(r/2),h;return t[0]=d/m,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(h=1/(s-a),t[10]=(a+s)*h,t[14]=2*a*s*h):(t[10]=-1,t[14]=-2*s),t}var H=D,j=B('<main class="svelte-1ht3dhn"><canvas id="gl-canvas" class="svelte-1ht3dhn"></canvas></main>');function $(t,r){U(r,!1);const m=`
        attribute vec4 aVertexPosition;
        uniform mat4 uModelViewMatrix;
        uniform mat4 uProjectionMatrix;
        void main() {
            gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;
        }
    `;let s,a;const d=async e=>{try{const i=await fetch(e);if(!i.ok)throw new Error(`Failed to load shader: ${i.statusText}`);return await i.text()}catch(i){throw console.error("Error loading shader file:",i),i}},h=(e,i,o)=>{const n=e.createShader(i);if(!n){alert("Unable to create shader");return}return e.shaderSource(n,o),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(alert(`An error occurred compiling the shaders: ${e.getShaderInfoLog(n)}`),e.deleteShader(n),null)},p=(e,i,o)=>{const n=h(e,e.VERTEX_SHADER,i),f=h(e,e.FRAGMENT_SHADER,o);if(!n||!f){alert("Unable to create vertex or fragment shaders");return}const c=e.createProgram();return e.attachShader(c,n),e.attachShader(c,f),e.linkProgram(c),e.getProgramParameter(c,e.LINK_STATUS)?c:(alert(`Unable to initialize the shader program: ${e.getProgramInfoLog(c)}`),null)},u=e=>{const i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i);const o=[1,1,-1,1,1,-1,-1,-1];return e.bufferData(e.ARRAY_BUFFER,new Float32Array(o),e.STATIC_DRAW),i},x=e=>({position:u(e)}),A=(e,i,o)=>{const f=e.FLOAT,c=!1,l=0,b=0;e.bindBuffer(e.ARRAY_BUFFER,i.position),e.vertexAttribPointer(o.attribLocations.vertexPosition,2,f,c,l,b),e.enableVertexAttribArray(o.attribLocations.vertexPosition)},P=(e,i,o,n)=>{e.clearColor(0,0,0,1),e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);const f=45*Math.PI/180,c=e.canvas,l=c.clientWidth/c.clientHeight,b=.1,T=100,y=R();H(y,f,l,b,T);const F=R();I(F,F,[-0,0,-6]),A(e,i,o),e.useProgram(o.program),e.uniformMatrix4fv(o.uniformLocations.projectionMatrix,!1,y),e.uniformMatrix4fv(o.uniformLocations.modelViewMatrix,!1,F);const E=(n-s)*.001;e.uniform1f(o.uniformLocations.time,E),e.drawArrays(e.TRIANGLE_STRIP,0,4)},v=(e,i,o)=>{const n=f=>{P(e,i,o,f),a=requestAnimationFrame(n)};s=performance.now(),n(s)},w=e=>{const i=e.clientWidth,o=e.clientHeight,n=window.devicePixelRatio||1,f=Math.floor(i*n),c=Math.floor(o*n);if(e.width!==f||e.height!==c){e.width=f,e.height=c;const l=e.getContext("webgl");l==null||l.viewport(0,0,f,c)}},S=async()=>{try{const e=await d("/shaders/test.frag"),i=document.querySelector("#gl-canvas");w(i);const o=i==null?void 0:i.getContext("webgl");if(o===null){alert("Unable to initialize WebGL. Your browser or machine may not support it.");return}const n=p(o,m,e);if(!n){alert("Unable to create shaderProgram");return}const f={program:n,attribLocations:{vertexPosition:o.getAttribLocation(n,"aVertexPosition")},uniformLocations:{projectionMatrix:o.getUniformLocation(n,"uProjectionMatrix"),modelViewMatrix:o.getUniformLocation(n,"uModelViewMatrix"),time:o.getUniformLocation(n,"uTime")}},c=x(o);v(o,c,f)}catch(e){console.log("Failed to initialize WebGL application:",e),alert("Failed to load shader files, check console for details")}};_(()=>(S(),()=>{a&&cancelAnimationFrame(a)})),z();var M=j();V(t,M),C()}export{$ as component};
