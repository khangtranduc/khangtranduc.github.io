import"../chunks/CWj6FrbW.js";import"../chunks/DIt9Bumx.js";import{o as _}from"../chunks/39mzmLjH.js";import{p as B,f as E,b as U,c as y}from"../chunks/CMtSGoh-.js";import{i as C}from"../chunks/D5SIYpj2.js";var M=E('<main class="svelte-1ht3dhn"><canvas id="gl-canvas" class="svelte-1ht3dhn"></canvas></main>');function V(h,l){B(l,!1);const p=`
        attribute vec4 aVertexPosition;
        void main() {
            gl_Position = aVertexPosition;
        }
    `;let s,c,u=0,m=0;const S=async t=>{try{const o=await fetch(t);if(!o.ok)throw new Error(`Failed to load shader: ${o.statusText}`);return await o.text()}catch(o){throw console.error("Error loading shader file:",o),o}},f=(t,o,e)=>{const r=t.createShader(o);if(!r){alert("Unable to create shader");return}return t.shaderSource(r,e),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:(alert(`An error occurred compiling the shaders: ${t.getShaderInfoLog(r)}`),t.deleteShader(r),null)},A=(t,o,e)=>{const r=f(t,t.VERTEX_SHADER,o),n=f(t,t.FRAGMENT_SHADER,e);if(!r||!n){alert("Unable to create vertex or fragment shaders");return}const i=t.createProgram();return t.attachShader(i,r),t.attachShader(i,n),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)?i:(alert(`Unable to initialize the shader program: ${t.getProgramInfoLog(i)}`),null)},b=t=>{const o=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,o);const e=[1,1,-1,1,1,-1,-1,-1];return t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW),o},P=t=>({position:b(t)}),L=(t,o,e)=>{const n=t.FLOAT,i=!1,a=0,d=0;t.bindBuffer(t.ARRAY_BUFFER,o.position),t.vertexAttribPointer(e.attribLocations.vertexPosition,2,n,i,a,d),t.enableVertexAttribArray(e.attribLocations.vertexPosition)},R=(t,o,e,r)=>{t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT);const n=t.canvas;L(t,o,e),t.useProgram(e.program);const i=(r-s)*.001;t.uniform1f(e.uniformLocations.time,i),t.uniform2f(e.uniformLocations.resolution,n.width,n.height);const a=u/n.clientWidth,d=1-m/n.clientHeight;t.uniform2f(e.uniformLocations.mouse,a,d),t.drawArrays(t.TRIANGLE_STRIP,0,4)},v=t=>{const e=t.target.getBoundingClientRect();u=t.clientX-e.left,m=t.clientY-e.top},w=(t,o,e)=>{const r=n=>{R(t,o,e,n),c=requestAnimationFrame(r)};s=performance.now(),r(s)},x=t=>{const o=t.clientWidth,e=t.clientHeight,r=window.devicePixelRatio||1,n=Math.floor(o*r),i=Math.floor(e*r);if(t.width!==n||t.height!==i){t.width=n,t.height=i;const a=t.getContext("webgl");a==null||a.viewport(0,0,n,i)}},F=async()=>{try{const t=await S("/shaders/test.frag"),o=document.querySelector("#gl-canvas");o.addEventListener("mousemove",v),x(o);const e=o==null?void 0:o.getContext("webgl");if(e===null){alert("Unable to initialize WebGL. Your browser or machine may not support it.");return}const r=A(e,p,t);if(!r){alert("Unable to create shaderProgram");return}const n={program:r,attribLocations:{vertexPosition:e.getAttribLocation(r,"aVertexPosition")},uniformLocations:{time:e.getUniformLocation(r,"uTime"),resolution:e.getUniformLocation(r,"uResolution"),mouse:e.getUniformLocation(r,"uMouse")}},i=P(e);w(e,i,n)}catch(t){console.log("Failed to initialize WebGL application:",t),alert("Failed to load shader files, check console for details")}};_(()=>(F(),()=>{c&&cancelAnimationFrame(c)})),C();var T=M();U(h,T),y()}export{V as component};
